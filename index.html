<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Poker Lobby</title>
  <style>
    body { font-family: sans-serif; background: white; text-align: center; padding: 2rem; }
    .card { display: inline-block; margin: 5px; padding: 1rem; border: 1px solid black; border-radius: 8px; width: 60px; height: 90px; font-size: 24px; cursor: pointer; }
    .card.disabled { opacity: 0.4; pointer-events: none; }
    .popup { position: fixed; top: 10%; left: 50%; transform: translateX(-50%); background: #fff; border: 1px solid #000; padding: 1rem; width: 300px; z-index: 100; }
    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 50; }
    input { padding: 0.5rem; font-size: 16px; }
    button { margin: 5px; padding: 0.5rem 1rem; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Poker Lobby</h1>
  <div id="main"></div>

  <script>
    const sampleCards = ["♠A", "♦10", "♣7", "♥K", "♠3"];
    let lobbyCode = "";
    let joined = false;
    let training = false;
    let selected = null;
    let table = [];
    let points = { player: 0, bot: 0 };

    const cardValue = (card) => {
      const v = card.slice(1);
      return { J:11, Q:12, K:13, A:14 }[v] || parseInt(v);
    };

    const randomCard = () => sampleCards[Math.floor(Math.random() * sampleCards.length)];

    const playCard = (i) => {
      if (selected !== null) return;
      selected = i;
      const playerCard = sampleCards[i];
      const botCard = randomCard();
      table.push({ player: playerCard, bot: botCard });

      const pVal = cardValue(playerCard);
      const bVal = cardValue(botCard);

      if (pVal > bVal) points.player++;
      else if (bVal > pVal) points.bot++;

      render();
      setTimeout(() => { selected = null; render(); }, 1500);
    };

    const render = () => {
      document.getElementById("main").innerHTML = joined ? `
        <h2>${training ? "Trainingsmodus" : "Lobby-Code: " + lobbyCode}</h2>
        <div>
          ${sampleCards.map((c, i) => `
            <div class="card ${selected !== null ? 'disabled' : ''}" onclick="playCard(${i})">${c}</div>
          `).join("")}
          <br/>
          <button onclick="showInfo()">?</button>
          <button onclick="showTable()">Tisch anzeigen</button>
        </div>
        <p>Punkte – Du: ${points.player} | Bot: ${points.bot}</p>
      ` : `
        <button onclick="createLobby()">Lobby erstellen</button><br/>
        <input id="codeInput" placeholder="Lobby-Code eingeben" maxlength="6" />
        <button onclick="joinLobby()">Beitreten</button><br/>
        <button onclick="startTraining()">Gegen Bot trainieren</button>
      `;
    };

    const createLobby = () => {
      lobbyCode = Math.random().toString(36).substr(2, 6).toUpperCase();
      joined = true; training = false;
      render();
    };

    const joinLobby = () => {
      const code = document.getElementById("codeInput").value.trim().toUpperCase();
      if (code.length === 6) {
        lobbyCode = code; joined = true; training = false;
        render();
      }
    };

    const startTraining = () => {
      joined = true; training = true;
      render();
    };

    const showInfo = () => {
      const overlay = document.createElement("div");
      overlay.className = "overlay";
      overlay.onclick = () => document.body.removeChild(overlay);

      const popup = document.createElement("div");
      popup.className = "popup";
      popup.innerHTML = `
        <h3>Poker Hände</h3>
        <ul style="text-align:left; font-size: 14px;">
          <li><b>High Card:</b> keine Kombination</li>
          <li><b>Ein Paar:</b> zwei gleiche Karten</li>
          <li><b>Zwei Paare:</b> zwei verschiedene Paare</li>
          <li><b>Drilling:</b> drei gleiche Karten</li>
          <li><b>Straße:</b> fünf aufeinanderfolgende Karten</li>
          <li><b>Flush:</b> fünf Karten derselben Farbe</li>
          <li><b>Full House:</b> Drilling + ein Paar</li>
          <li><b>Vierling:</b> vier gleiche Karten</li>
          <li><b>Straight Flush:</b> Straße + Flush</li>
          <li><b>Royal Flush:</b> 10 bis Ass in einer Farbe</li>
        </ul>
        <button onclick="document.body.removeChild(this.parentElement.parentElement)">Schließen</button>
      `;
      overlay.appendChild(popup);
      document.body.appendChild(overlay);
    };

    const showTable = () => {
      const overlay = document.createElement("div");
      overlay.className = "overlay";
      overlay.onclick = () => document.body.removeChild(overlay);

      const popup = document.createElement("div");
      popup.className = "popup";
      popup.innerHTML = `
        <h3>Gespielte Karten</h3>
        <ul style="text-align:left; font-size: 14px;">
          ${table.length === 0 ? "<li>Keine Karten gespielt</li>" :
            table.map((r, i) => `<li>Runde ${i+1}: Du – ${r.player}, Bot – ${r.bot}</li>`).join("")}
        </ul>
        <button onclick="document.body.removeChild(this.parentElement.parentElement)">Schließen</button>
      `;
      overlay.appendChild(popup);
      document.body.appendChild(overlay);
    };

    window.playCard = playCard;
    window.createLobby = createLobby;
    window.joinLobby = joinLobby;
    window.startTraining = startTraining;
    window.showInfo = showInfo;
    window.showTable = showTable;

    render();
  </script>
</body>
</html>
